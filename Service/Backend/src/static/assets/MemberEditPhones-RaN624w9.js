import{d as f,r as c,y as b,z as _,x as n,h as d,o as g,c as x,a as P,e as V,A as $,k as l}from"./index-CK62fWor.js";import{_ as v}from"./CustomForm.vue_vue_type_script_setup_true_lang-CDWfceke.js";import"./CustomSelect.vue_vue_type_script_setup_true_lang-S8JB5u0-.js";const y={class:"container"},k=f({__name:"MemberEditPhones",setup(D){const o=c([]),a=c({}),p=[{color:"secondary",text:"返回",method:()=>n("/members")},{color:"success",text:"新增",method:()=>m()},{color:"primary",text:"更新",method:()=>i(),needValid:!0}],r=b(()=>{var e;return(e=$.members)==null?void 0:e.editId});_(()=>{r.value?u():n("/members")});const u=()=>{d("get",`/apis/members/${r.value}`).then(e=>{e.data.phones.forEach((t,s)=>{m(),a[`phones[${s}]`]=t})})},m=()=>{let e=o.length;o.push({label:`電話/手機號碼 #${e+1}`,type:"text",depValue:`phones[${e}]`})},i=()=>{d("patch",`/apis/members/${r.value}/phones`,h()).then(e=>{l("success",e.message),n("/members")}).catch(e=>{l("error",e.message)})},h=()=>{let e={},t=o.filter(s=>a[s.depValue]);return e.phones=t.map(s=>a[s.depValue]),e};return(e,t)=>(g(),x("div",y,[t[1]||(t[1]=P("h3",{class:"m-4 text-center"},"編輯電話 / 手機號碼",-1)),V(v,{fields:o,buttons:p,formData:a,"onUpdate:formData":t[0]||(t[0]=s=>a=s)},null,8,["fields","formData"])]))}});export{k as default};
