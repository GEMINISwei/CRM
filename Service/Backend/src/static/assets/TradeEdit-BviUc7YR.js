import{d as g,r as u,y as i,z as F,h as p,o as k,c as T,a as m,e as w,A as r,x as C,k as D}from"./index-CK62fWor.js";import{_ as E}from"./CustomForm.vue_vue_type_script_setup_true_lang-CDWfceke.js";import"./CustomSelect.vue_vue_type_script_setup_true_lang-S8JB5u0-.js";const K={class:"container"},$=g({__name:"TradeEdit",setup(B){const t=u([{label:"編號",type:"text",depValue:"custom_no"},{label:"末五碼",type:"text",depValue:"last_five_code",hidden:!0},{label:"時間紀錄",type:"time",depValue:"record_time",hidden:!0},{label:"繳費代碼",type:"text",depValue:"pay_code",hidden:!0},{label:"門市",type:"text",depValue:"store",hidden:!0},{label:"虛擬帳號",type:"text",depValue:"v_account",hidden:!0},{label:"金額修正 (多給的)",type:"number",depValue:"money_correction",hidden:!0},{label:"遊戲幣修正 (多給的)",type:"number",depValue:"game_coin_correction",hidden:!0}]),n=u({}),_=[{color:"secondary",text:"返回",method:()=>c(),needValid:!0},{color:"primary",text:"更新",method:()=>x(),needValid:!0}],s=i(()=>{var e;return(e=r.trades)==null?void 0:e.editId}),f=i(()=>{var e;return(e=r.trades)==null?void 0:e.showKind}),l=i(()=>{var e;return(e=r.trades)==null?void 0:e.basyType});F(()=>{y(),h()});const y=()=>{p("get",`/apis/trades/${s.value}`).then(e=>{t.forEach(d=>{n[d.depValue]=e.data.details[d.depValue]}),n.money_correction=e.data.money_correction,n.game_coin_correction=e.data.game_coin_correction})},h=()=>{let e=t.findIndex(a=>a.depValue=="last_five_code"),d=t.findIndex(a=>a.depValue=="record_time"),o=t.findIndex(a=>a.depValue=="pay_code"),V=t.findIndex(a=>a.depValue=="store"),I=t.findIndex(a=>a.depValue=="v_account"),b=t.findIndex(a=>a.depValue=="money_correction"),v=t.findIndex(a=>a.depValue=="game_coin_correction");switch(f.value){case"bank":t[e].hidden=!1,t[d].hidden=!1;break;case"supermarket":t[o].hidden=!1,t[V].hidden=!1;break;case"v_account":t[e].hidden=!1,t[I].hidden=!1;break}l.value=="money_in"?t[v].hidden=!1:l.value=="money_out"&&(t[b].hidden=!1)},c=()=>{var e,d,o;C("/properties/details",{showTitle:(e=r.trades)==null?void 0:e.propertyName,showKind:(d=r.trades)==null?void 0:d.showKind,showId:(o=r.trades)==null?void 0:o.propertyId})},x=()=>{let e={details:n,money_correction:n.money_correction,game_coin_correction:n.game_coin_correction};p("patch",`/apis/trades/${s.value}`,e).then(d=>{D("question","一筆交流紀錄已更新 !"),c()})};return(e,d)=>(k(),T("div",K,[d[1]||(d[1]=m("div",{class:"m-4"},[m("h3",{class:"text-center"},"編輯交流單")],-1)),w(E,{fields:t,buttons:_,formData:n,"onUpdate:formData":d[0]||(d[0]=o=>n=o)},null,8,["fields","formData"])]))}});export{$ as default};
