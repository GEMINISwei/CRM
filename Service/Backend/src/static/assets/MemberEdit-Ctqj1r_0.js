import{d as _,r as c,y as f,z as x,x as n,h as r,o as V,c as y,a as g,e as h,A as v,k as l}from"./index-CK62fWor.js";import{_ as E}from"./CustomForm.vue_vue_type_script_setup_true_lang-CDWfceke.js";import"./CustomSelect.vue_vue_type_script_setup_true_lang-S8JB5u0-.js";const M={class:"container"},w=_({__name:"MemberEdit",setup($){const s=c([{label:"遊戲暱稱",type:"text",depValue:"nickname",required:!0,disabled:!0},{label:"性別",type:"select",depValue:"sex",options:[{text:"男",value:"男"},{text:"女",value:"女"}]},{label:"首次交流時間",type:"date",depValue:"f_communication_time"},{label:"交流方式",type:"select",depValue:"f_communication_way"},{label:"首次交易金額",type:"text",depValue:"f_communication_amount"},{label:"註解",type:"textarea",depValue:"description"}]),o=c(s.reduce((e,t)=>({...e,[t.depValue]:""}),{})),i=[{color:"success",text:"返回",method:()=>n("/members")},{color:"primary",text:"更新",method:()=>p(),needValid:!0},{color:"danger",text:"刪除",method:()=>b()}],m=f(()=>{var e;return(e=v.members)==null?void 0:e.editId});x(()=>{m.value?(d(),u()):n("/members")});const d=()=>{r("get",`/apis/members/${m.value}`).then(e=>{s.forEach(t=>{let a="";t.depValue=="f_communication_time"?e.data[t.depValue]&&(a=e.data[t.depValue].slice(0,10)):a=e.data[t.depValue],o[t.depValue]=a})})},u=()=>{r("get","/apis/settings?collection_name=members").then(e=>{let t=s.findIndex(a=>a.depValue=="f_communication_way");s[t].options=e.data.communication_ways.map(a=>({text:a,value:a}))})},p=()=>{r("patch",`/apis/members/${m.value}`,o).then(e=>{l("success",e.message),n("/members")}).catch(e=>{l("error",e.message)})},b=()=>{r("delete",`/apis/members/${m.value}`).then(e=>{l("success",`會員 "${e.data.game_name}" 已刪除 !`),n("/members")})};return(e,t)=>(V(),y("div",M,[t[1]||(t[1]=g("h3",{class:"m-4 text-center"},"編輯會員",-1)),h(E,{fields:s,buttons:i,formData:o,"onUpdate:formData":t[0]||(t[0]=a=>o=a)},null,8,["fields","formData"])]))}});export{w as default};
