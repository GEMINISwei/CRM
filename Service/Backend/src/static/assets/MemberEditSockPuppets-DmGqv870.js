import{d as _,r as m,y as b,z as k,x as p,h as n,o as h,c as g,a as x,e as P,A as V,k as u}from"./index-CK62fWor.js";import{_ as $}from"./CustomForm.vue_vue_type_script_setup_true_lang-CDWfceke.js";import"./CustomSelect.vue_vue_type_script_setup_true_lang-S8JB5u0-.js";const v={class:"container"},B=_({__name:"MemberEditSockPuppets",setup(y){const o=m([]),a=m({}),d=[{color:"secondary",text:"返回",method:()=>p("/members")},{color:"success",text:"新增",method:()=>c()},{color:"primary",text:"更新",method:()=>i(),needValid:!0}],r=b(()=>{var e;return(e=V.members)==null?void 0:e.editId});k(()=>{r.value?l():p("/members")});const l=()=>{n("get",`/apis/members/${r.value}`).then(e=>{e.data.sock_puppets.forEach((t,s)=>{c(),a[`sock_puppets[${s}]`]=t})})},c=()=>{let e=o.length;o.push({label:`遊戲分身 #${e+1}`,type:"text",depValue:`sock_puppets[${e}]`})},i=()=>{n("patch",`/apis/members/${r.value}/sock_puppets`,f()).then(e=>{u("success",e.message),p("/members")}).catch(e=>{u("error",e.message)})},f=()=>{let e={},t=o.filter(s=>a[s.depValue]);return e.sock_puppets=t.map(s=>a[s.depValue]),e};return(e,t)=>(h(),g("div",v,[t[1]||(t[1]=x("h3",{class:"m-4 text-center"},"編輯遊戲分身",-1)),P($,{fields:o,buttons:d,formData:a,"onUpdate:formData":t[0]||(t[0]=s=>a=s)},null,8,["fields","formData"])]))}});export{B as default};
