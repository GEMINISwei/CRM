import{d as b,r as m,y as h,z as _,x as c,h as u,o as g,c as x,a as A,e as V,A as $,k as d}from"./index-CK62fWor.js";import{_ as v}from"./CustomForm.vue_vue_type_script_setup_true_lang-CDWfceke.js";import"./CustomSelect.vue_vue_type_script_setup_true_lang-S8JB5u0-.js";const y={class:"container"},k=b({__name:"MemberEditAccounts",setup(D){const o=m([]),a=m({}),l=[{color:"secondary",text:"返回",method:()=>c("/members")},{color:"success",text:"新增",method:()=>n()},{color:"primary",text:"更新",method:()=>p(),needValid:!0}],r=h(()=>{var e;return(e=$.members)==null?void 0:e.editId});_(()=>{r.value?i():c("/members")});const i=()=>{u("get",`/apis/members/${r.value}`).then(e=>{e.data.accounts.forEach((t,s)=>{n(),a[`accounts[${s}]`]=t})})},n=()=>{let e=o.length;o.push({label:`銀行帳戶 #${e+1}`,type:"text",depValue:`accounts[${e}]`})},p=()=>{u("patch",`/apis/members/${r.value}/accounts`,f()).then(e=>{d("success",e.message),c("/members")}).catch(e=>{d("error",e.message)})},f=()=>{let e={},t=o.filter(s=>a[s.depValue]);return e.accounts=t.map(s=>a[s.depValue]),e};return(e,t)=>(g(),x("div",y,[t[1]||(t[1]=A("h3",{class:"m-4 text-center"},"編輯銀行帳戶",-1)),V(v,{fields:o,buttons:l,formData:a,"onUpdate:formData":t[0]||(t[0]=s=>a=s)},null,8,["fields","formData"])]))}});export{k as default};
